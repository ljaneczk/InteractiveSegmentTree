<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Main
Description : Module responsible for interaction with user.

Module contains two versions of communication with user. The version should be estimated before running the project.
The first option (by implication) is mainWithMessages, which enables communication and instrucing user.
The second option is mainWithoutMessages, with this option you can work without neccessary coments.
This option might be helpful when you are going to use piping in console.

Some functions may use type Val = Int to differentiate values stored in SegmentTree from Int used to specify boundaries and size.
-}</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Main</span><span class="hs-special">(</span><a href="Main.html#main"><span class="hs-identifier hs-var">main</span></a><span class="hs-special">,</span><a href="Main.html#mainWithMessages"><span class="hs-identifier hs-var">mainWithMessages</span></a><span class="hs-special">,</span><a href="Main.html#mainWithoutMessages"><span class="hs-identifier hs-var">mainWithoutMessages</span></a><span class="hs-special">,</span><a href="Main.html#interactWithUser"><span class="hs-identifier hs-var">interactWithUser</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="SegmentTree.html"><span class="hs-identifier">SegmentTree</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">type</span><span> </span><a name="Val"><a href="Main.html#Val"><span class="hs-identifier">Val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- | This function checks if interval given by user is correct.</span><span>
</span><a name="line-26"></a><span class="hs-identifier">isIntervalIncorrect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-27"></a><a name="isIntervalIncorrect"><a href="Main.html#isIntervalIncorrect"><span class="hs-identifier">isIntervalIncorrect</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679022339"><a href="#local-6989586621679022339"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679022339"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-28"></a><span class="hs-identifier">isIntervalIncorrect</span><span> </span><a name="local-6989586621679022340"><a href="#local-6989586621679022340"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679022341"><a href="#local-6989586621679022341"><span class="hs-identifier">x1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022342"><a href="#local-6989586621679022342"><span class="hs-identifier">x2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022343"><a href="#local-6989586621679022343"><span class="hs-identifier">x3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679022341"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679022341"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679022342"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679022342"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679022340"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | This function proceeds users' commands.</span><span>
</span><a name="line-32"></a><span class="hs-identifier">interactWithUser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SegmentTree.html#SegmentTree"><span class="hs-identifier hs-type">SegmentTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><a name="interactWithUser"><a href="Main.html#interactWithUser"><span class="hs-identifier">interactWithUser</span></a></a><span> </span><a name="local-6989586621679022344"><a href="#local-6989586621679022344"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022345"><span class="hs-identifier hs-var">interactWithUser'</span></a><span>
</span><a name="line-34"></a><span>	</span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">interactWithUser'</span><span> </span><a name="local-6989586621679022345"><a href="#local-6989586621679022345"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-35"></a><span>		</span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLine</span><span>
</span><a name="line-36"></a><span>		</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">input</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;:q&quot;</span><span> </span><a href="#local-6989586621679022626"><span class="hs-operator hs-var">||</span></a><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;q&quot;</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;quit&quot;</span><span> </span><a href="#local-6989586621679022626"><span class="hs-operator hs-var">||</span></a><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;exit&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>			</span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">putStr</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-38"></a><span>			</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-39"></a><span>				</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">beg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">input</span><span>
</span><a name="line-40"></a><span>				</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">input</span><span>
</span><a name="line-41"></a><span>				</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-42"></a><span>				</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isIntervalIncorrect</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>					</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-44"></a><span>						</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Invalid interval - please ensure that interval is included in SegmentTree boundaries.&quot;</span><span>
</span><a name="line-45"></a><span>						</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-46"></a><span>					</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-47"></a><span>						</span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">beg</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-48"></a><span>							</span><span class="hs-string">&quot;set&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-49"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-51"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for set update.&quot;</span><span>
</span><a name="line-52"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-53"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-54"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-glyph">:</span><span class="hs-identifier">a4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-55"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">updateSetValueOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">a3</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-56"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t2</span><span>
</span><a name="line-57"></a><span>							</span><span class="hs-string">&quot;add&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-58"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-60"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for add update.&quot;</span><span>
</span><a name="line-61"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-62"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-63"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-glyph">:</span><span class="hs-identifier">a4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-64"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">updateAddValueOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">a3</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-65"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t2</span><span>
</span><a name="line-66"></a><span>							</span><span class="hs-string">&quot;min&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-67"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-69"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for min query.&quot;</span><span>
</span><a name="line-70"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-71"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-72"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-73"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">updateAddValueOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-74"></a><span>										</span><span class="hs-identifier">print</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">queryMinimumOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t2</span><span>
</span><a name="line-76"></a><span>							</span><span class="hs-string">&quot;max&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-77"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-79"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for max query.&quot;</span><span>
</span><a name="line-80"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-81"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-82"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-83"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">updateAddValueOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-84"></a><span>										</span><span class="hs-identifier">print</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">queryMaximumOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t2</span><span>
</span><a name="line-86"></a><span>							</span><span class="hs-string">&quot;sum&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-87"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-89"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for sum query.&quot;</span><span>
</span><a name="line-90"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-91"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-92"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-93"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">updateAddValueOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-94"></a><span>										</span><span class="hs-identifier">print</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">querySumOnInterval</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t2</span><span>
</span><a name="line-96"></a><span>							</span><span class="hs-string">&quot;get&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-97"></a><span>								</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">args</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>									</span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-99"></a><span>										</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Too few arguments for tre query.&quot;</span><span>
</span><a name="line-100"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-101"></a><span>									</span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-102"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a1</span><span class="hs-glyph">:</span><span class="hs-identifier">a2</span><span class="hs-glyph">:</span><span class="hs-identifier">a3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">args</span><span>
</span><a name="line-103"></a><span>										</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">l1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getPartOfSegmentTree</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-104"></a><span>										</span><span class="hs-identifier">print</span><span> </span><span class="hs-identifier">l1</span><span>
</span><a name="line-105"></a><span>										</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-106"></a><span>							</span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-107"></a><span>								</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Invalid operation - check your operation and arguments.&quot;</span><span>
</span><a name="line-108"></a><span>								</span><span class="hs-identifier">interactWithUser'</span><span> </span><span class="hs-identifier">t1</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | This is main function. In this function the appropriate version of cummication with user is called.</span><span>
</span><a name="line-113"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><a name="main"><a href="Main.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Main.html#mainWithMessages"><span class="hs-identifier hs-var">mainWithMessages</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | This function communicates with user and instructs them.</span><span>
</span><a name="line-118"></a><span class="hs-identifier">mainWithMessages</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><a name="mainWithMessages"><a href="Main.html#mainWithMessages"><span class="hs-identifier">mainWithMessages</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-120"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;Please give one number: n - number of numbers stored in segment tree.&quot;</span><span>
</span><a name="line-121"></a><span>		</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLine</span><span>
</span><a name="line-122"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-glyph">:</span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier hs-var">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findSegmentTreeSize</span><span> </span><a href="SegmentTree.html#findSegmentTreeSize"><span class="hs-identifier hs-var">n1</span></a><span>
</span><a name="line-124"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Please give &lt;= &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot; initial numbers in tree - values in tree given from beginning.&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>		</span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLine</span><span>
</span><a name="line-126"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">initials</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><a name="local-6989586621679023076"><a href="#local-6989586621679023076"><span class="hs-identifier">read</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Val</span><span class="hs-special">]</span><span>
</span><a name="line-127"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">initialize</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-128"></a><span>		</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">insertInitialNumbers</span><span> </span><span class="hs-number">0</span><span> </span><a href="SegmentTree.html#insertInitialNumbers"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="SegmentTree.html#insertInitialNumbers"><span class="hs-identifier hs-var">initials</span></a><span> </span><span class="hs-identifier">t0</span><span>
</span><a name="line-129"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Please introduce operations on intervals included in [0,&quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;).&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Remember that intervals are in format [beg,end), where beg &gt;= 0 and end &lt;= &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;When you want to close program, type one of [q,:q,quit,exit] and press enter.&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>		</span><span class="hs-identifier">interactWithUser</span><span> </span><a href="Main.html#interactWithUser"><span class="hs-identifier hs-var">n1</span></a><span> </span><a href="Main.html#interactWithUser"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-133"></a><span>		</span><span class="hs-identifier">putStrLn</span><span> </span><span class="hs-string">&quot;See you next time!&quot;</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | This function communicates with user without instruction.</span><span>
</span><a name="line-137"></a><span class="hs-identifier">mainWithoutMessages</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><a name="mainWithoutMessages"><a href="Main.html#mainWithoutMessages"><span class="hs-identifier">mainWithoutMessages</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-139"></a><span>	</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLine</span><span>
</span><a name="line-140"></a><span>	</span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-glyph">:</span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>	</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findSegmentTreeSize</span><span> </span><a href="SegmentTree.html#findSegmentTreeSize"><span class="hs-identifier hs-var">n1</span></a><span>
</span><a name="line-142"></a><span>	</span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLine</span><span>
</span><a name="line-143"></a><span>	</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">initials</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679023084"><a href="#local-6989586621679023084"><span class="hs-identifier">map</span></a></a><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Val</span><span class="hs-special">]</span><span>
</span><a name="line-144"></a><span>	</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">initialize</span><span> </span><span class="hs-number">0</span><span> </span><a href="SegmentTree.html#initialize"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-145"></a><span>	</span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">insertInitialNumbers</span><span> </span><span class="hs-number">0</span><span> </span><a href="SegmentTree.html#insertInitialNumbers"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier">initials</span><span> </span><a href="#local-6989586621679023084"><span class="hs-identifier hs-var">t0</span></a><span>
</span><a name="line-146"></a><span>	</span><span class="hs-identifier">interactWithUser</span><span> </span><a href="Main.html#interactWithUser"><span class="hs-identifier hs-var">n1</span></a><span> </span><a href="Main.html#interactWithUser"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-147"></a></pre></body></html>